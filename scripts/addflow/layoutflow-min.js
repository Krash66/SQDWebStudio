/* LayoutFlow for HTML5
   v1.0.0.1 - June 2014
   Copyright (c) 2012-2014 Lassalle Technologies. All rights reserved.
   http://www.lassalle.com
   Author: Patrick Lassalle mailto:plassalle@lassalle.com 
   If you do not own a commercial license, this file shall be governed by the license 
   agreement that can be found at: http://www.lassalle.com/html5/license_evaluation.pdf
   If you own a commercial license, this file shall be governed by the license 
   agreement that can be found at: http://www.lassalle.com/html5/license_commercial.pdf
   */

var LayoutFlow={ForceDirected:function(flow,vertexDistance,xmargin,ymargin,isUnmoveableNodesAccepted,isRandomStart,isStepEvent){var sm,lP,qH,pO,pF,oW,pp,oK,ot,ny,pP,rZ,pb,nt,oZ,mN,mh,mi,bc,mq,ob,size,nf,lT,lQ,step,qr,qO,qV,nN,shake,qX,qj,pI,pn,nQ,qD;sm=50;lP=5;qH=1000;pO=3;pF=1.5;oW=0.06;pp=0.055;oK=0.4;ot=0.9;ny=1.0;pP=0.01;rZ=0.005;pb=1.0;if(flow===null||flow===undefined){return;}if(vertexDistance===undefined||vertexDistance<=0){vertexDistance=sm;}if(xmargin===undefined||xmargin<=0){xmargin=lP;}if(ymargin===undefined||ymargin<=0){ymargin=lP;}if(isUnmoveableNodesAccepted===undefined||isUnmoveableNodesAccepted===null){isUnmoveableNodesAccepted=false;}if(isRandomStart===undefined||isRandomStart===null){isRandomStart=true;}if(isStepEvent===undefined||isStepEvent===null){isStepEvent=false;}lQ=vertexDistance*vertexDistance;nQ=0.0;nf={x:0,y:0};step=pb;qr=oK;qO=ot;qV=ny;nN=pP;shake=rZ;qX=pF*vertexDistance;qj=oW*vertexDistance;pn=pp;mq=[];nt={x:0,y:0,w:0,h:0};nG();oS();oZ=new nB();if(isRandomStart){tZ();}lT=0;for(mi=0;mi<mh.length;mi++){mN=mh[mi];size=mN.length;va();tz();vh();lT+=xmargin+nt.w;}oa();function oS(){var i,R,mc,u,F,J,bA,lZ;for(i=0;i<bc.length;i++){os(bc[i]);}for(i=0;i<mq.length;i++){mc=mq[i];F=mc.F;bA=F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];lZ=J.org===F?J.dst:J.org;if(!J.isExcludedFromLayout&&J.org!==J.dst&& !lZ.isExcludedFromLayout){u=lZ.nC;mc.mx.push(u);}}}};function oa(){var i,R,aM,mc,J,bA,pt,mW,mT;flow.beginUpdate();for(i=0;i<mq.length;i++){mc=mq[i];mc.F.nh={x:mc.F.getLeft(),y:mc.F.getTop()};mc.F.setLeft(mc.x-mc.w/2);mc.F.setTop(mc.y-mc.h/2);bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}J.aP=true;J.setIsOrgPointAdjustable(false);J.setIsDstPointAdjustable(false);}}for(i=0;i<mq.length;i++){mc=mq[i];bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}if(J.aP){J.aP=false;}else{continue;}if(J.org!==J.dst){J.setLineStyle('polyline');if(J.points.length>2){J.clearPoints();}if(J.pinOrg!==undefined&&J.pinOrg!==null){mW=J.org.getLeft()-J.org.nh.x;mT=J.org.getTop()-J.org.nh.y;pt=J.points[0];J.setPoint(pt.x+mW,pt.y+mT,0);}if(J.pinDst!==undefined&&J.pinDst!==null){mW=J.dst.getLeft()-J.dst.nh.x;mT=J.dst.getTop()-J.dst.nh.y;pt=J.points[1];J.setPoint(pt.x+mW,pt.y+mT,1);}}else{mW=mc.F.getLeft()-mc.F.nh.x;mT=mc.F.getTop()-mc.F.nh.y;if(J.pinOrg!==undefined&&J.pinOrg!==null){aM=0;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}for(aM=1;aM<J.points.length-1;aM++){pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}if(J.pinDst!==undefined&&J.pinDst!==null){aM=J.points.length-1;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}}}}flow.endUpdate();};function os(F){var mc;mc=new ax(F);F.nC=mc;mq.push(mc);};function nG(){var i,F,items;items=flow.getItems();bc=[];for(i in items){if(flow.isNode(items[i])){F=items[i];if(!F.isExcludedFromLayout){bc.push(items[i]);}}}};function tZ(){var i,mc,scale;scale=vertexDistance*Math.sqrt(mq.length);for(i=0;i<mq.length;i++){mc=mq[i];if(!isUnmoveableNodesAccepted||mc.F.isXMoveable){mc.x=qN()%(scale+1)+scale/2;}if(!isUnmoveableNodesAccepted||mc.F.isYMoveable){mc.y=qN()%(scale+1)+scale/2;}}};function va(){var i,aM,mc;pI=pn*pn*lQ*size;qD=Math.min(pO*size*size,qH);for(i=0;i<mN.length;i++){mc=mN[i];mc.oM=mc.mx.length;mc.pa=1.0+mc.oM/3.0;mc.nH=qj;nQ+=mc.nH*mc.nH;nf.x+=mc.x;nf.y+=mc.y;}ob=new Array(size);for(aM=0;aM<size;aM++){ob[aM]=aM;}};function vh(){mG();tC();};function tz(){var oI;for(oI=0;oI<qD;oI++){if(nQ<pI){break;}round();if(isStepEvent){if(uT(oI)){break;}}}};function round(){var i,mc,mO;for(i=0;i<size;i++){mc=ve(i);mO=qn(mc);qF(mc,mO);}};function qF(mc,mO){var be,qy,nU,d;be=mc.nH;if(be!==0.0){nQ-=be*be;nU=mO.x*mc.mO.x+mO.y*mc.mO.y;qy=mO.x*mc.mO.y-mO.y*mc.mO.x;if(Math.abs(nU)>0.5){be+=qr*nU;be=Math.min(be,qX);}else{mc.dir+=qO*qy/be;be-=be*qV*Math.abs(mc.dir)/size;be=Math.max(be,2);}mc.nH=be;nQ+=be*be;}d={x:mO.x*step*be,y:mO.y*step*be};if(!isUnmoveableNodesAccepted||mc.F.isXMoveable){mc.x+=d.x;nf.x+=d.x;}if(!isUnmoveableNodesAccepted||mc.F.isYMoveable){mc.y+=d.y;nf.y+=d.y;}mc.mO=mO;};function qn(mv){var mO,d,e,n,i,mc,pi;mO={x:0,y:0};d={x:0,y:0};n=Math.floor(shake*vertexDistance);mO.x=qN()%(2*n+1)-n;mO.y=qN()%(2*n+1)-n;mO.x+=(nf.x/size-mv.x)*mv.pa*nN;mO.y+=(nf.y/size-mv.y)*mv.pa*nN;for(i=0;i<mN.length;i++){mc=mN[i];if(mv!==mc){d.x=mv.x-mc.x;d.y=mv.y-mc.y;e=d.x*d.x+d.y*d.y;if(e!==0.0){mO.x+=d.x*lQ/e;mO.y+=d.y*lQ/e;}}}for(i=0;i<mv.mx.length;i++){mc=mv.mx[i];d.x=mv.x-mc.x;d.y=mv.y-mc.y;e=(d.x*d.x+d.y*d.y)/mv.pa;mO.x-=d.x*e/lQ;mO.y-=d.y*e/lQ;}pi=Math.sqrt(mO.x*mO.x+mO.y*mO.y);if(pi!==0){mO.x/=pi;mO.y/=pi;}return mO;};function ve(sS){var n,aM,i;n=size-sS;aM=qN()%n;i=ob[aM];ob[aM]=ob[n-1];ob[n-1]=i;return mN[i];};function mG(){var i,mc,mA;for(i=0;i<mN.length;i++){mc=mN[i];mA={x:mc.x-mc.w/2,y:mc.y-mc.h/2,w:mc.w,h:mc.h};if(i===0){nt=mA;}else{nt=jJ(nt,mA);}}};function jJ(mF,mo){var left,top,right,bottom;right=Math.max(mF.x+mF.w,mo.x+mo.w);bottom=Math.max(mF.y+mF.h,mo.y+mo.h);left=Math.min(mF.x,mo.x);top=Math.min(mF.y,mo.y);return{x:left,y:top,w:right-left,h:bottom-top};};function tC(){var i,mc;for(i=0;i<mN.length;i++){mc=mN[i];mc.x+= -nt.x+mc.w/2+xmargin+lT;mc.y+= -nt.y+mc.h/2+ymargin;}};function qN(){return Math.floor(Math.random()*2147483647);};function nB(){var mC,nd;this.pD=function(){var mv,mc,i;mC=0;nd=0;while(mC<mq.length){mv=null;for(i=0;i<mq.length;i++){mc=mq[i];if(mc.K===0){nd++;mv=mc;break;}}if(mv!==null){lC(mv);}}nP();}();function lC(mv){var mc,i;mv.K=nd;mC++;for(i=0;i<mv.mx.length;i++){mc=mv.mx[i];if(mc.K===0){lC(mc);}}};function nP(){var i,aM,mc;mh=new Array(nd);for(aM=0;aM<nd;aM++){mh[aM]=[];}for(i=0;i<mq.length;i++){mc=mq[i];mh[mc.K-1].push(mc);}}};function ax(F){this.F=F;this.x=F.getLeft();this.y=F.getTop();this.w=F.getWidth();this.h=F.getHeight();this.mO={x:0,y:0};this.nH=0;this.dir=0;this.pa=0;this.oM=0;this.K=0;this.mx=[];};function uT(oI){var event;event=document.createEvent("Event");event.initEvent("step",true,true);event.oI=oI,document.dispatchEvent(event);}},Tree:function(flow,layerDistance,vertexDistance,drawingStyle,orientation,xmargin,ymargin){var nJ,pr,lP,py,pj,bc,mq,root,nl,oZ,mN,mh,mi,lT;nJ=50;pr=50;lP=5;uo='layered';uH='north';if(flow===null||flow===undefined){return;}if(vertexDistance===undefined||vertexDistance<=0){vertexDistance=nJ;}if(layerDistance===undefined||layerDistance<=0){layerDistance=pr;}if(orientation===undefined||orientation===null){orientation=pj;}if(drawingStyle===undefined||drawingStyle===null){drawingStyle=py;}if(xmargin===undefined||xmargin<=0){xmargin=lP;}if(ymargin===undefined||ymargin<=0){ymargin=lP;}mq=[];nt={x:0,y:0,w:0,h:0};nl=nJ/2;nG();oS();if(!us()){alert('Each connected part of the graph must be a rooted tree!');return;}oZ=new nB();lT=0;for(mi=0;mi<mh.length;mi++){mN=mh[mi];root=uO();switch(drawingStyle){case 'layered':mt();break;case 'radial':ug();break;}}oa();function nG(){var i,F,items;items=flow.getItems();bc=[];for(i in items){if(flow.isNode(items[i])){F=items[i];if(!F.isExcludedFromLayout){bc.push(items[i]);}}}};function oS(){var i,R,mc,u,e,F,J,bA,lZ,mA;for(i=0;i<bc.length;i++){F=bc[i];mc=new ax(F);mc.V={x:F.x,y:F.y};mA={x:F.getLeft()-F.getWidth()/2,y:F.getTop()-F.getHeight()/2,w:F.getWidth(),h:F.getHeight()};mc.x=mA.x+mA.w/2;mc.y=mA.y+mA.h/2;if(orientation==='north'||orientation==='south'){mc.w=mA.w;mc.h=mA.h;}else{mc.w=mA.h;mc.h=mA.w;}F.nC=mc;mq.push(mc);}for(i=0;i<mq.length;i++){mc=mq[i];bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(!J.isExcludedFromLayout){if(J.org===mc.F){if(J.org!==J.dst){if(!J.dst.isExcludedFromLayout){u=J.dst.nC;e=new bd(mc,u,J);mc.lF.push(e);u.lY.push(e);}}}}}}};function oa(){var nt,be,pt,i,R,aM,mc,bA,J,x,y,mW,mT;flow.beginUpdate();nt=mG();for(i=0;i<mq.length;i++){mc=mq[i];x=mc.x;y=mc.y;mc.F.nh={x:mc.F.getLeft(),y:mc.F.getTop()};x-=nt.x;y-=nt.y;if(drawingStyle==='layered'){switch(orientation){case 'north':break;case 'west':be=x;x=y;y=nt.w-be;be=mc.w;mc.w=mc.h;mc.h=be;break;case 'south':x=nt.w-x;y=nt.h-y;break;case 'east':be=x;x=nt.h-y;y=be;be=mc.w;mc.w=mc.h;mc.h=be;break;}}x-=mc.w/2;y-=mc.h/2;x+=xmargin;y+=ymargin;mc.F.setLeft(x);mc.F.setTop(y);bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}J.aP=true;J.setIsOrgPointAdjustable(false);J.setIsDstPointAdjustable(false);}}for(i=0;i<mq.length;i++){mc=mq[i];bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}if(J.aP){J.aP=false;}else{continue;}if(J.org!==J.dst){J.setLineStyle('polyline');if(J.points.length>2){J.clearPoints();}if(J.pinOrg!==undefined&&J.pinOrg!==null){mW=J.org.getLeft()-J.org.nh.x;mT=J.org.getTop()-J.org.nh.y;pt=J.points[0];J.setPoint(pt.x+mW,pt.y+mT,0);}if(J.pinDst!==undefined&&J.pinDst!==null){mW=J.dst.getLeft()-J.dst.nh.x;mT=J.dst.getTop()-J.dst.nh.y;pt=J.points[1];J.setPoint(pt.x+mW,pt.y+mT,1);}}else{mW=mc.F.getLeft()-mc.F.nh.x;mT=mc.F.getTop()-mc.F.nh.y;if(J.pinOrg!==undefined&&J.pinOrg!==null){aM=0;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}for(aM=1;aM<J.points.length-1;aM++){pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}if(J.pinDst!==undefined&&J.pinDst!==null){aM=J.points.length-1;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}}}}flow.endUpdate();};function mG(){var i,mc,mA,nt;for(i=0;i<mq.length;i++){mc=mq[i];mA={x:mc.x-mc.w/2,y:mc.y-mc.h/2,w:mc.w,h:mc.h};if(i===0){nt=mA;}else{nt=jJ(nt,mA);}}return nt;};function jJ(mF,mo){var left,top,right,bottom;right=Math.max(mF.x+mF.w,mo.x+mo.w);bottom=Math.max(mF.y+mF.h,mo.y+mo.h);left=Math.min(mF.x,mo.x);top=Math.min(mF.y,mo.y);return{x:left,y:top,w:right-left,h:bottom-top};};function uO(){var mc;mc=mN[0];while(mc.aO()!==null){mc=mc.aO();}return mc;};function mt(){var ro,te,layers;if(root===null)return;ro=0;te=(5*vertexDistance)/4;layers=[];sB(root,null,null);su(root);uD(root);uw(root);uj();function sB(mc,bD,au){mc.au=au;if(bD!==null&&au===null){bD.qM=mc;}if(au!==null){au.ak=mc;}};function su(bD){var au,R,e,mc;au=null;for(R=0;R<bD.lF.length;R++){e=bD.lF[R];mc=e.dst;sB(mc,bD,au);su(mc);au=mc;}};function uD(mv){sa(mv,0);rj(mv,0);};function sa(mv,lX){var ns,mf,qP,oq;mv.prev=uY(lX);uI(lX,mv);mv.oJ=0;if(mv.qz()){if(mv.ru()){oq=sY(mv.au,mv);mv.lW=mv.au.lW+vertexDistance+oq;}else{mv.lW=0;}}else{mf=mv.aJ();ns=mf;sa(ns,lX+1);while(mf!==null&&mf.qx()){mf=mf.ak;sa(mf,lX+1);}qP=(ns.lW+mf.lW)/2;oq=sY(mv.au,mv);if(mv!==null&&mv.ru()){mv.lW=mv.au.lW+vertexDistance+oq;mv.oJ=mv.lW-qP;tA(mv);}else{mv.lW=qP;}}};function uY(lX){var aM,da;for(aM=0;aM<layers.length;aM++){if(aM===lX){da=layers[aM];return da.nF;}}return null;};function uI(lX,mc){var cy,da,oP,aM;cy=mc.h;if(layers.length===0){da=new sJ();da.nF=mc;da.oz=cy;layers.push(da);}else{for(aM=0;aM<layers.length;aM++){da=layers[aM];if(aM===lX){da.nF=mc;if(da.oz<cy){da.oz=cy;}break;}else{if(aM+1===layers.length){oP=new sJ();oP.nF=null;oP.oz=cy;layers.push(oP);}}}}};function sY(au,ak){var pH=0;if(au!==null){pH+=au.w/2;}if(ak!==null){pH+=ak.w/2;}return pH;};function tA(mv){var ns,ae,ql,qQ,distance,mc,ra,pU,rg,pk,i,oq,rX;ns=mv.aJ();ae=ns.bV();ql=1;while(ns!==null&&ae!==null){qQ=0;pU=0;rg=ns;pk=ae;for(i=0;i<ql;i++){rg=rg.aO();pk=pk.aO();qQ+=rg.oJ;pU+=pk.oJ;}oq=sY(ns,ae);distance=ae.lW+pU+te+oq-(ns.lW+qQ);if(distance>0){ra=0;for(mc=mv;mc!==null&&mc!==pk;mc=mc.au){ra++;}if(mc!==null){rX=distance/ra;for(mc=mv;mc!==pk;mc=mc.au){mc.lW+=distance;mc.oJ+=distance;distance-=rX;}}else{return;}}ql++;if(ns!==null&&ns.qz()){ns=sT(mv,0,ql);}else{ns=ns.aJ();}ae=(ns!==null)?ns.bV():null;}};function uU(lX){var qI,aM,da;qI=0;for(aM=0;aM<layers.length;aM++){da=layers[aM];if(aM===lX){qI+=da.oz/2;break;}else{qI+=da.oz;}}return qI;};function sT(mv,lX,ma){var ns,mf;if(lX===ma){ns=mv;}else if(mv!==null&&mv.qz()){ns=null;}else{mf=mv.aJ();ns=sT(mf,lX+1,ma);while(ns===null&&mf!==null&&mf.qx()){mf=mf.ak;ns=sT(mf,lX+1,ma);}}return ns;};function rj(mv,lX){var re;mv.x=mv.lW+ro;mv.y=lX*layerDistance+uU(lX);re=ro;if(mv!==null&&mv.rK()){re+=mv.oJ;ro=re;rj(mv.aJ(),lX+1);re-=mv.oJ;}if(mv!==null&&mv.qx()){ro=re;rj(mv.ak,lX);}};function uw(mv){nt={x:mv.x-mv.w/2,y:mv.y-mv.h/2,w:mv.w,h:mv.h};sM(mv);};function sM(mv){var mc,mA;for(mc=mv.aJ();mc!==null;mc=mc.ak){mA={x:mc.x-mc.w/2,y:mc.y-mc.h/2,w:mc.w,h:mc.h};nt=jJ(nt,mA);sM(mc);}};function uj(){var mc,i;for(i=0;i<mN.length;i++){mc=mN[i];mc.x+=lT-nt.x;mc.y+= -nt.y;}lT+=nl+nt.w;}};function ug(){var pw,qA,qs;pw=null;qA=0;qs=0;if(root===null)return;sI(root);root.ma=0;root.pd=2*Math.PI;root.angle=0;root.x=0;root.y=0;pw=root;rG(root);vg();function sI(mv){var R,e,mc,pe;pe=0;for(R=0;R<mv.lF.length;R++){e=mv.lF[R];mc=e.dst;if(mc.lF.length===0){pe++;mc.pe=1;}else{pe+=sI(mc);}}mv.pe=pe;return pe;};function rG(bD){var R,e,mc,rN,sc;for(R=0;R<bD.lF.length;R++){e=bD.lF[R];mc=e.dst;mc.ma=bD.ma+layerDistance;rN=(mc.pe/bD.pe)*bD.pd;sc=(2*Math.acos(bD.ma/mc.ma));mc.pd=Math.min(rN,sc);if(qA!==mc.ma||pw!==bD){qs=bD.angle-bD.pd/2;}mc.angle=qs+mc.pd/2;mc.x=root.x-Math.cos(mc.angle)*mc.ma;mc.y=root.y+Math.sin(mc.angle)*mc.ma;qs+=mc.pd;qA=mc.ma;pw=bD;}for(R=0;R<bD.lF.length;R++){e=bD.lF[R];mc=e.dst;rG(mc);}};function vg(){var i,mc,mA;nt={x:0,y:0,w:0,h:0};for(i=0;i<mN.length;i++){mc=mN[i];mA={x:mc.x-mc.w/2,y:mc.y-mc.h/2,w:mc.w,h:mc.h};nt=jJ(nt,mA);}for(i=0;i<mN.length;i++){mc=mN[i];mc.x+=lT-nt.x;mc.y+= -nt.y;}lT+=nl+nt.w;}};function us(){var mY;function qC(){var result,i,R,mc,e;result=false;mY=0;for(i=0;i<mq.length;i++){mc=mq[i];if(!mc.G){oh(mc);}}for(i=0;i<mq.length;i++){mc=mq[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(e.dst.mY>e.org.mY){result=true;break;}}if(result){break;}}return result;};function oh(mc){var lZ,R,e;mc.G=true;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(e.org===mc&& !e.G){e.G=true;lZ=e.dst;if(!lZ.G){oh(lZ);}}}mc.mY=mY++;};for(i=0;i<mq.length;i++){mc=mq[i];if(mc.lY.length>1){return false;}}return!qC();};function nB(){var mC,nd;this.pD=function(){var mv,mc,i;mC=0;nd=0;while(mC<mq.length){mv=null;for(i=0;i<mq.length;i++){mc=mq[i];if(mc.K===0){nd++;mv=mc;break;}}if(mv!==null){lC(mv);}}nP();}();function lC(mv){var mc,i,e,R,bD;mv.K=nd;mC++;for(R=0;R<mv.lF.length;R++){e=mv.lF[R];mc=e.dst;if(mc.K===0){lC(mc);}}bD=mv.aO();if(bD!==null&&bD.K===0){lC(bD);}};function nP(){var i,aM,mc;mh=new Array(nd);for(aM=0;aM<nd;aM++){mh[aM]=[];}for(i=0;i<mq.length;i++){mc=mq[i];mh[mc.K-1].push(mc);}}};function sJ(){this.nF=null;this.oz=0;};function ax(F){var na;this.F=F;this.lY=[];this.lF=[];this.G=false;this.mY=0;this.x=0;this.y=0;this.w=0;this.h=0;this.V={x:0,y:0};this.K=0;this.lW=0;this.oJ=0;this.qM=null;this.au=null;this.ak=null;this.prev=null;this.ma=0;this.pd=0;this.angle=0;this.pe=0;na=this;this.aO=function(){var e;if(na.lY.length===0){return null;}else{e=na.lY[0];return e.org;}};this.aJ=function(){return na.qM;};this.bV=function(){return na.prev;};this.rK=function(){return(na.qM!==null);};this.ru=function(){return(na.au!==null);};this.qx=function(){return(na.ak!==null);};this.qz=function(){return(na.qM===null);};};function bd(org,dst,J){this.org=org;this.dst=dst;this.J=J;this.G=false;}},SeriesParallel:function(flow,layerDistance,vertexDistance,drawingStyle,orientation,xvertex,yvertex,xmargin,ymargin){var nJ,pr,py,rs,pj,lP,bc,mq,sC,pJ,oZ,mN,mh,mi,lT;nJ=80;pr=80;lP=5;pj='north';rs=20;py='busOrthogonalDrawing';if(flow===null||flow===undefined){return;}if(vertexDistance===undefined||vertexDistance<=0){vertexDistance=nJ;}if(layerDistance===undefined||layerDistance<=0){layerDistance=pr;}if(drawingStyle===undefined||drawingStyle===null){drawingStyle=py;}if(orientation===undefined||orientation===null){orientation=pj;}if(xvertex===undefined||xvertex<=0){xvertex=rs;}if(yvertex===undefined||yvertex<=0){yvertex=rs;}if(xmargin===undefined||xmargin<=0){xmargin=lP;}if(ymargin===undefined||ymargin<=0){ymargin=lP;}nt={x:0,y:0,w:0,h:0};mq=[];nG();oS();if(qC()){alert('The graph must be directed acyclic!');return;}oZ=new nB();lT=0;for(mi=0;mi<mh.length;mi++){mN=mh[mi];if(!uG()){return;}}oa();function nG(){var i,F,items;items=flow.getItems();bc=[];for(i in items){if(flow.isNode(items[i])){F=items[i];if(!F.isExcludedFromLayout){bc.push(items[i]);}}}};function oS(){var i,R,mc,u,J,bA,lZ;for(i=0;i<bc.length;i++){os(bc[i]);}for(i=0;i<mq.length;i++){mc=mq[i];bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.org===mc.F){lZ=J.dst;if(!J.isExcludedFromLayout&&J.org!==J.dst&& !lZ.isExcludedFromLayout){u=lZ.nC;pg(mc,u,J);}}}}};function oa(){var i,R,aM,mc,e,pt,be,nt,x,y,mW,mT,J,bA;flow.beginUpdate();nt=mG();for(i=0;i<mq.length;i++){mc=mq[i];x=mc.x;y=mc.y;mc.F.nh={x:mc.F.getLeft(),y:mc.F.getTop()};x-=nt.x;y-=nt.y;switch(orientation){case 'north':break;case 'west':be=x;x=y;y=nt.w-be;be=mc.w;mc.w=mc.h;mc.h=be;break;case 'south':x=nt.w-x;y=nt.h-y;break;case 'east':be=x;x=nt.h-y;y=be;be=mc.w;mc.w=mc.h;mc.h=be;break;}x-=mc.w/2;y-=mc.h/2;x+=xmargin;y+=ymargin;mc.F.setLeft(x);mc.F.setTop(y);mc.F.setWidth(mc.w);mc.F.setHeight(mc.h);bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}J.aP=true;J.setIsOrgPointAdjustable(false);J.setIsDstPointAdjustable(false);}}for(i=0;i<mq.length;i++){mc=mq[i];bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}if(J.aP){J.aP=false;}else{continue;}if(J.org!==J.dst){J.setLineStyle('polyline');if(J.points.length>2){J.clearPoints();}if(J.pinOrg!==undefined&&J.pinOrg!==null){mW=J.org.getLeft()-J.org.nh.x;mT=J.org.getTop()-J.org.nh.y;pt=J.points[0];J.setPoint(pt.x+mW,pt.y+mT,0);}if(J.pinDst!==undefined&&J.pinDst!==null){mW=J.dst.getLeft()-J.dst.nh.x;mT=J.dst.getTop()-J.dst.nh.y;pt=J.points[1];J.setPoint(pt.x+mW,pt.y+mT,1);}}else{mW=mc.F.getLeft()-mc.F.nh.x;mT=mc.F.getTop()-mc.F.nh.y;if(J.pinOrg!==undefined&&J.pinOrg!==null){aM=0;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}for(aM=1;aM<J.points.length-1;aM++){pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}if(J.pinDst!==undefined&&J.pinDst!==null){aM=J.points.length-1;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}}}}if(drawingStyle!=='straightLine'){for(i=0;i<mq.length;i++){mc=mq[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(e.lU.length>0){J=e.J;for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];pt.x-=nt.x;pt.y-=nt.y;switch(orientation){case 'north':break;case 'west':be=pt.x;pt.x=pt.y;pt.y=nt.w-be;break;case 'south':pt.x=nt.w-pt.x;pt.y=nt.h-pt.y;break;case 'east':be=pt.x;pt.x=nt.h-pt.y;pt.y=be;break;}pt.x+=xmargin;pt.y+=ymargin;if(aM===0){if(drawingStyle==='visibilityDrawing'){J.setPoint(pt.x,pt.y,0);}}else if(aM===e.lU.length-1){if(drawingStyle==='visibilityDrawing'){J.setPoint(pt.x,pt.y,J.points.length-1);}}else{J.addPoint(pt.x,pt.y);}}}}}}flow.endUpdate();};function mG(){var i,R,aM,mc,e,pt,mA,nt;for(i=0;i<mq.length;i++){mc=mq[i];mA={x:mc.x-mc.w/2,y:mc.y-mc.h/2,w:mc.w,h:mc.h};if(i===0){nt=mA;}else{nt=jJ(nt,mA);}}for(i=0;i<mq.length;i++){mc=mq[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];if(pt.x<nt.x){nt.w+=nt.x-pt.x;nt.x=pt.x;}else if(pt.x>nt.x+nt.w){nt.w+=pt.x-(nt.x+nt.w);}if(pt.y<nt.y){nt.h+=nt.y-pt.y;nt.y=pt.y;}else if(pt.y>nt.y+nt.h){nt.h+=pt.y-(nt.y+nt.h);}}}}return nt;};function jJ(mF,mo){var left,top,right,bottom;right=Math.max(mF.x+mF.w,mo.x+mo.w);bottom=Math.max(mF.y+mF.h,mo.y+mo.h);left=Math.min(mF.x,mo.x);top=Math.min(mF.y,mo.y);return{x:left,y:top,w:right-left,h:bottom-top};};function os(F){var mc;mc=new ax(F);F.nC=mc;mq.push(mc);};function pg(org,dst,J){var e;if(org===null||dst===null||org===dst){return null;}if(oB(org,dst)!==null){return null;}e=new bd(org,dst,J);org.lF.push(e);dst.lY.push(e);return e;};function rq(mc){var aM,e,aU;for(aM=mc.lF.length-1;aM>=0;aM--){e=mc.lF[aM];nV(e);}for(aM=mc.lY.length-1;aM>=0;aM--){e=mc.lY[aM];nV(e);}aU=mN.indexOf(mc);mN.splice(aU,1);};function nV(e){var aU;aU=e.org.lF.indexOf(e);e.org.lF.splice(aU,1);aU=e.dst.lY.indexOf(e);e.dst.lY.splice(aU,1);};function oB(org,dst){var i,e;for(i=0;i<org.lF.length;i++){e=org.lF[i];if(e.dst===dst){return e;}}return null;};function qC(){var result,i,mc,R,e,mY;result=false;mY=0;for(i=0;i<mq.length;i++){mc=mq[i];if(!mc.G){oh(mc);}}for(i=0;i<mq.length;i++){mc=mq[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(e.dst.mY>e.org.mY){result=true;break;}}if(result){break;}}return result;function oh(mc){var lZ,R,e;mc.G=true;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(e.org===mc&& !e.G){e.G=true;lZ=e.dst;if(!lZ.G){oh(lZ);}}}mc.mY=mY++;}};function uG(){var i,R,aM,mc,e,mA,pt;uu();pJ=new sV();if(!uB()){alert('The graph is not a series-parallel graph!');return false;}uz();pJ.sz();if(drawingStyle!=='visibilityDrawing'){tq();}for(i=0;i<mN.length;i++){mc=mN[i];mA={x:mc.x-mc.w/2,y:mc.y-mc.h/2,w:mc.w,h:mc.h};if(i===0){nt=mA;}else{nt=jJ(nt,mA);}}for(i=0;i<mN.length;i++){mc=mN[i];mc.x+=lT-nt.x;mc.y+= -nt.y;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];pt.x+=lT-nt.x;pt.y+= -nt.y;e.lU[aM]=pt;}}}lT+=xmargin+nt.w;return true;};function uB(){var i,R,mc,e,nq,nk,pW;for(i=0;i<mN.length;i++){mc=mN[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];pJ.uC(e);}}if(sD()){return true;}else{while(mN.length>2){pW=false;for(i=0;i<mN.length;i++){mc=mN[i];if(mc.sK()){pW=true;nq=mc.lY[0];nk=mc.lF[0];e=oB(nq.org,nk.dst);if(e===null){e=pg(nq.org,nk.dst,null);pJ.rW(nq,nk,e);}else{pJ.vf(nq,nk,e);}rq(mc);}}if(!pW){return false;}if(sD()){return true;}}}return false;};function tq(){var i,R,mc,u,e,dr,cX,bu,ad,O,ah,bm,pK;for(i=0;i<mN.length;i++){mc=mN[i];mc.w=xvertex;mc.h=yvertex;}for(i=0;i<mN.length;i++){mc=mN[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];dr=yvertex/2;cX=layerDistance/4;u=e.dst;bu={x:mc.x,y:mc.y+dr};ad={x:mc.x,y:mc.y+dr+cX};O=e.lU[0];ah=e.lU[1];bm={x:u.x,y:u.y-dr-cX};pK={x:u.x,y:u.y-dr};O.y=ad.y;ah.y=bm.y;e.lU=[];e.lU.push(bu);if(!ic(bu,ad,O)){e.lU.push(ad);}if(!ic(ad,O,ah)){e.lU.push(O);}if(!ic(O,ah,bm)){e.lU.push(ah);}if(!ic(ah,bm,pK)){e.lU.push(bm);}e.lU.push(pK);}}function ic(ad,O,ah){return((ad.x===O.x&&O.x===ah.x)||(ad.y===O.y&&O.y===ah.y));}};function sD(){var rz,nb;if(mN.length===2){rz=mN[0];nb=mN[1];if(rz.lF.length===1||nb.lF.length===1){return true;}}return false;};function uu(){var i,mc;sC=mN.slice();for(i=0;i<mN.length;i++){mc=mN[i];mc.rC=mc.lF.slice();mc.rM=mc.lY.slice();}};function uz(){var i,mc;mN=sC.slice();for(i=0;i<mN.length;i++){mc=mN[i];mc.lF=mc.rC.slice();mc.lY=mc.rM.slice();}};function pQ(be,e){var na;this.edge=e;this.bI=null;this.children=[];this.rect={x:0,y:0,w:0,h:0};this.ad={x:0,y:0};this.O={x:0,y:0};this.org=null;this.dst=null;this.level=0;this.mg=0;this.pl='';this.code=0;this.type=be;na=this;if(e!==null){na.org=e.org;na.dst=e.dst;}else{na.org=null;na.dst=null;}function toString(){var qY="("+na.org.F.text+","+na.dst.F.text+")";if(qa()){return "S "+qY;}else if(pV()){return "P "+qY;}else{return "Q "+qY;}};function uM(){var i,offset;offset="";for(i=0;i<na.level;i++){offset+="   ";}return offset;};this.nz=function(ue,left){var aU;if(na.bI!==null){aU=na.bI.children.indexOf(na);na.bI.children.splice(aU,1);}na.bI=ue;if(na.bI!==null){level=na.bI.level+1;if(left===null||left===undefined){na.bI.children.push(na);}else{aU=na.bI.children.indexOf(left);na.bI.children.splice(aU+1,0,na);}}};this.nX=function(){return na.type==='QNode';};this.qa=function(){return na.type==='SNode';};this.pV=function(){return na.type==='PNode';};this.tU=function(){na.ad={x:vertexDistance/2,y:0};na.O={x:vertexDistance/2,y:layerDistance};na.rect={x:0,y:0,w:vertexDistance,h:layerDistance};};this.qL=function(oH){var i,nn;na.rect.x*=oH;na.rect.w*=oH;if(na.nX()){na.ad.x=na.ad.x*oH;na.O.x=na.O.x*oH;}else{for(i=0;i<na.children.length;i++){nn=na.children[i];nn.qL(oH);}}};this.pu=function(oH){var i,nn;na.rect.y*=oH;na.rect.h*=oH;if(na.nX()){na.ad.y=na.ad.y*oH;na.O.y=na.O.y*oH;}else{for(i=0;i<na.children.length;i++){nn=na.children[i];nn.pu(oH);}}};this.si=function(mA){var i,nn;na.rect.x+=mA.x;na.rect.y+=mA.y+mA.h;if(na.nX()){na.ad.x+=mA.x;na.ad.y+=mA.y+mA.h;na.O.x+=mA.x;na.O.y+=mA.y+mA.h;}else{for(i=0;i<na.children.length;i++){nn=na.children[i];nn.si(mA);}}};this.rE=function(mA){var i,nn;na.rect.x+=mA.x+mA.w;na.rect.y+=mA.y;if(na.nX()){na.ad.x+=mA.x+mA.w;na.ad.y+=mA.y;na.O.x+=mA.x+mA.w;na.O.y+=mA.y;}else{for(i=0;i<na.children.length;i++){nn=na.children[i];nn.rE(mA);}}};};function sV(){var root,na;root=null;na=this;this.uC=function(e){var qf;lD=new pQ('QNode',e);if(e!==null){e.nn=lD;}root=lD;return lD;};this.rW=function(nq,nk,e){var qf;lD=new pQ('SNode',null);nq.nn.nz(lD);nk.nn.nz(lD);lD.org=nq.org;lD.dst=nk.dst;if(e!==null){e.nn=lD;}root=lD;return lD;};this.vf=function(nq,nk,e){var nn,qf;nn=na.rW(nq,nk,null);lD=new pQ('PNode',null);nn.nz(lD);if(e!==null){e.nn.nz(lD);lD.org=e.org;lD.dst=e.dst;e.nn=lD;}root=lD;return lD;};this.sz=function(){rI(root,0);uv(root);qc(root);sv(root);tf(root);};function rI(lD,level){var i,aM,nn,lJ;lD.level=level;for(i=0;i<lD.children.length;i++){nn=lD.children[i];rI(nn,level+1);}for(i=lD.children.length-1;i>=0;i--){nn=lD.children[i];if(!nn.nX()){if(nn.type===lD.type){for(aM=nn.children.length-1;aM>=0;aM--){lJ=nn.children[aM];lJ.nz(lD,nn);}nn.nz(null);}}}};function uv(root){var qi,lV,mg,i,R,aM,qf,nn,c,tc,ps,s;qi=0;lV=[];sX(root,0);lV=[];for(i=0;i<qi+1;i++){lV.push(new Level());}sN(root);for(mg=qi;mg>=0;mg--){for(R=0;R<lV[mg].oG.length;R++){lD=lV[mg].oG[R];if(lD.children!==null&&lD.children.length>0){for(aM=0;aM<lD.children.length;aM++){nn=lD.children[aM];c="0".charCodeAt(0)+nn.code;s=String.fromCharCode(c);lD.pl=lD.pl+s;}if(lD.type==='PNode'){tc=lD.pl.split("");tc.sort();}}}ps=[];for(R=0;R<lV[mg].oG.length;R++){nn=lV[mg].oG[R];ps.push(nn.pl);}ps.sort();for(R=0;R<lV[mg].oG.length;R++){nn=lV[mg].oG[R];aM=1;for(i=0;i<ps.length;i++){if(i>0&&ps[i]!==ps[i-1]){aM++;}if(nn.pl===ps[i]){nn.code=aM;break;}}}}function sN(lD){var level,i,nn;level=lV[lD.mg];level.oG.push(lD);for(i=0;i<lD.children.length;i++){nn=lD.children[i];sN(nn);}};function sX(lD,level){var i,nn;lD.mg=level;qi=Math.max(qi,level);if(lD.nX()){lD.pl="0";}for(i=0;i<lD.children.length;i++){nn=lD.children[i];sX(nn,level+1);}};function Level(){this.oG=[];}};function qc(lD){var i,R,aM,nn,oR,oY,qm,pB,nA,oj,pm,aU;if(lD.nX()){return;}else if(lD.qa()){for(i=0;i<lD.children.length;i++){nn=lD.children[i];qc(nn);}}else if(lD.pV()){oR=[];for(i=0;i<lD.children.length;i++){nn=lD.children[i];oR.push(nn.code);}oR.sort();oY=[];oY.push(oR[0]);qm=1;for(R=1;R<oR.length;R++){if(oR[R]!==oR[R-1]){oY.push(oR[R]);qm++}}pB=[];for(R=0;R<qm;R++){pB.push(0);for(i=0;i<lD.children.length;i++){nn=lD.children[i];if(nn.code===oY[R]){pB[R]++;}}}aM=0;nA=0;for(R=0;R<pB.length;R++){if(pB[R]%2!==0){aM=R;nA++;}}if(nA===0||nA===1){for(R=qm-1;R>=0;R--){oj=[];for(i=0;i<lD.children.length;i++){nn=lD.children[i];if(nn.code===oY[R]){oj.push(nn);}}for(i=0;i<oj.length;i++){nn=oj[i];aU=lD.children.indexOf(nn);lD.children.splice(aU,1);}for(i=0;i<Math.floor(oj.length/2);i++){lD.children.splice(0,0,oj[i]);}for(i=Math.floor(oj.length/2);i<oj.length;i++){lD.children.push(oj[i]);}}if(nA===1){pm=[];for(i=0;i<lD.children.length;i++){nn=lD.children[i];if(nn.code===oY[aM]){pm.push(nn);}}for(i=0;i<pm.length;i++){nn=pm[i];aU=lD.children.indexOf(nn);lD.children.splice(aU,1);}for(i=0;i<pm.length;i++){nn=pm[i];lD.children.splice(Math.floor(lD.children.length/2),0,nn);}}}else if(nA>1){}for(i=0;i<lD.children.length;i++){nn=lD.children[i];qc(nn);}}};function sv(lD){var i,aM,nn,lJ;if(lD.nX()){lD.tU();}else if(lD.qa()){for(i=0;i<lD.children.length;i++){nn=lD.children[i];sv(nn);if(i>0){lJ=lD.children[i-1];if(lJ.rect.w<nn.rect.w){for(aM=0;aM<i;aM++){lJ=lD.children[aM];lJ.qL(nn.rect.w/lJ.rect.w);}}else if(lJ.rect.w>nn.rect.w){nn.qL(lJ.rect.w/nn.rect.w);}nn.si(lJ.rect);}}for(i=0;i<lD.children.length;i++){nn=lD.children[i];lD.rect=jJ(lD.rect,nn.rect);}}else if(lD.pV()){for(i=0;i<lD.children.length;i++){nn=lD.children[i];sv(nn);if(i>0){lJ=lD.children[i-1];if(lJ.rect.h<nn.rect.h){for(aM=0;aM<i;aM++){lJ=lD.children[aM];lJ.pu(nn.rect.h/lJ.rect.h);}}else if(lJ.rect.h>nn.rect.h){nn.pu(lJ.rect.h/nn.rect.h);}nn.rE(lJ.rect);}}for(i=0;i<lD.children.length;i++){nn=lD.children[i];lD.rect=jJ(lD.rect,nn.rect);}}};function tf(lD){var org,dst,i,nn;org=lD.org;dst=lD.dst;if(!org.rf){org.x=lD.rect.x+lD.rect.w/2;org.y=lD.ad.y;org.w=lD.rect.w;org.h=3;org.rf=true;}if(!dst.rf){dst.x=lD.rect.x+lD.rect.w/2;dst.y=lD.O.y;dst.w=lD.rect.w;dst.h=3;dst.rf=true;}if(lD.nX()){org.y=lD.ad.y;dst.y=lD.O.y;lD.edge.lU.push(lD.ad);lD.edge.lU.push(lD.O);}for(i=0;i<lD.children.length;i++){nn=lD.children[i];tf(nn);}};function toString(){var sA=new sg();return sA.rA(root);};function sg(){var sr=null;function rA(root){sr=null;rH(root);return sr;};function rH(lD){var i,nn;sr+=lD.uM()+lD.toString()+"\r\n";for(i=0;i<lD.children.length;i++){nn=lD.children[i];rH(nn);}}}};function nB(){var mC,nd;this.pD=function(){var mv,mc,i;mC=0;nd=0;while(mC<mq.length){mv=null;for(i=0;i<mq.length;i++){mc=mq[i];if(mc.K===0){nd++;mv=mc;break;}}if(mv!==null){lC(mv);}}nP();}();function lC(mv){var mc,i,e,R,bI;mv.K=nd;mC++;for(R=0;R<mv.lF.length;R++){e=mv.lF[R];mc=e.dst;if(mc.K===0){lC(mc);}}for(R=0;R<mv.lY.length;R++){e=mv.lY[R];mc=e.org;if(mc.K===0){lC(mc);}}bI=mv.aO();if(bI!==null&&bI.K===0){lC(bI);}};function nP(){var i,aM,mc;mh=new Array(nd);for(aM=0;aM<nd;aM++){mh[aM]=[];}for(i=0;i<mq.length;i++){mc=mq[i];mh[mc.K-1].push(mc);}}};function ax(F){var na;this.F=F;this.lY=[];this.lF=[];this.rC=[];this.rM=[];this.G=false;this.K=0;this.mY=0;this.x=0;this.y=0;this.w=0;this.h=0;this.rf=false;na=this;this.sK=function(){return na.lF.length===1&&na.lY.length===1;};this.aO=function(){var e;if(na.lY.length===0){return null;}else{e=na.lY[0];return e.org;}};};function bd(org,dst,J){this.org=org;this.dst=dst;this.J=J;this.G=false;this.nn=null;this.lU=[];}},Orthogonal:function(flow,orientation,xgridSize,ygridSize,nodeSizeRatio,xmargin,ymargin){var nJ,pr,qG,pj,lP,sO,bc,mq,ml,om,oc,ov,oZ,mN,mh,mi,lT;lP=5;pj='north';sO=50;qG=20;if(flow===null||flow===undefined){return;}if(orientation===undefined||orientation===null){orientation=pj;}if(xgridSize===undefined||xgridSize<=0){xgridSize=qG;}if(ygridSize===undefined||ygridSize<=0){ygridSize=qG;}if(nodeSizeRatio===undefined||nodeSizeRatio<=0){nodeSizeRatio=sO;}if(xmargin===undefined||xmargin<=0){xmargin=lP;}if(ymargin===undefined||ymargin<=0){ymargin=lP;}ov={w:xgridSize*nodeSizeRatio/100,h:ygridSize*nodeSizeRatio/100};om=0;oc=0;ml=[];mq=[];nt={x:0,y:0,w:0,h:0};nG();oS();oZ=new nB(mq);lT=0;for(mi=0;mi<mh.length;mi++){mN=mh[mi];tn();sP();ud();}oa();function nG(){var i,F,items;items=flow.getItems();bc=[];for(i in items){if(flow.isNode(items[i])){F=items[i];if(!F.isExcludedFromLayout){bc.push(items[i]);}}}};function oS(){var i,R,mc,u,J,bA,lZ;for(i=0;i<bc.length;i++){os(bc[i]);}for(i=0;i<mq.length;i++){mc=mq[i];bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.org===mc.F){lZ=J.dst;if(!J.isExcludedFromLayout&&J.org!==J.dst&& !lZ.isExcludedFromLayout){u=lZ.nC;pg(mc,u,J);}}}}};function oa(){var nt,mc,i,e,R,x,y,bA,J,aM,pt,mL,O,mA,w,h;flow.beginUpdate();uN();nt=mG();for(i=0;i<mq.length;i++){mc=mq[i];if(mc.F===null){continue;}x=mc.x*xgridSize;y=mc.y*ygridSize;x+= -nt.x-ov.w/2;y+= -nt.y-ov.h/2;x+=xmargin;y+=ymargin;mc.F.nh={x:mc.F.getLeft(),y:mc.F.getTop()};mc.F.setLeft(x);mc.F.setTop(y);mc.F.setWidth(ov.w+(mc.cols-1)*xgridSize);mc.F.setHeight(ov.h+(mc.rows-1)*ygridSize);bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}J.aP=true;J.setIsOrgPointAdjustable(true);J.setIsDstPointAdjustable(true);}for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}if(J.aP){J.aP=false;}else{continue;}if(J.org===J.dst){mW=mc.F.getLeft()-mc.F.nh.x;mT=mc.F.getTop()-mc.F.nh.y;if(J.pinOrg!==undefined&&J.pinOrg!==null){aM=0;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}for(aM=1;aM<J.points.length-1;aM++){pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}if(J.pinDst!==undefined&&J.pinDst!==null){aM=J.points.length-1;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}}}}for(i=0;i<mq.length;i++){mc=mq[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];J=e.J;J.setLineStyle('polyline');if(J.points.length>2){J.clearPoints();}for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];mL={x:pt.x*xgridSize,y:pt.y*ygridSize};mL.x-=nt.x;mL.y-=nt.y;mL.x+=xmargin;mL.y+=ymargin;if(aM===0){O=e.lU[1];mA={x:J.org.x,y:J.org.y,w:J.org.w,h:J.org.h};if(pt.x===O.x){if(O.y>pt.y){mL.y=mA.y+mA.h;}else{mL.y=mA.y;}}if(pt.y===O.y){if(O.x>pt.x){mL.x=mA.x+mA.w;}else{mL.x=mA.x;}}J.setPoint(mL.x,mL.y,0);}else if(aM===e.lU.length-1){O=e.lU[e.lU.length-2];mA={x:J.dst.x,y:J.dst.y,w:J.dst.w,h:J.dst.h};if(pt.x===O.x){if(O.y>pt.y){mL.y=mA.y+mA.h;}else{mL.y=mA.y;}}if(pt.y===O.y){if(O.x>pt.x){mL.x=mA.x+mA.w;}else{mL.x=mA.x;}}J.setPoint(mL.x,mL.y,J.points.length-1);}else{J.addPoint(mL.x,mL.y);}}}}flow.endUpdate();};function mG(){var i,R,aM,mc,e,pt,mL,mA,nt;for(i=0;i<mq.length;i++){mc=mq[i];mA={x:mc.x*xgridSize-ov.w/2,y:mc.y*ygridSize-ov.h/2,w:ov.w+(mc.cols-1)*xgridSize,h:ov.h+(mc.rows-1)*ygridSize};if(i===0){nt=mA;}else{nt=jJ(nt,mA);}}for(i=0;i<mq.length;i++){mc=mq[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(e.org.F!==e.J.org){e.lU.reverse();}for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];mL={x:pt.x*xgridSize,y:pt.y*ygridSize};if(mL.x<nt.x){nt.w+=nt.x-mL.x;nt.x=mL.x;}else if(mL.x>(nt.x+nt.w)){nt.w+=mL.x-(nt.x+nt.w);}if(mL.y<nt.y){nt.h+=nt.y-mL.y;nt.y=mL.y;}else if(mL.y>(nt.y+nt.h)){nt.h+=mL.y-(nt.y+nt.h);}}}}return nt;};function jJ(mF,mo){var left,top,right,bottom;right=Math.max(mF.x+mF.w,mo.x+mo.w);bottom=Math.max(mF.y+mF.h,mo.y+mo.h);left=Math.min(mF.x,mo.x);top=Math.min(mF.y,mo.y);return{x:left,y:top,w:right-left,h:bottom-top};};function os(F){var mc;mc=new ax(F);F.nC=mc;mq.push(mc);return mc;};function pg(org,dst,J){var e;if(org===null||dst===null||org===dst){return null;}if(oB(org,dst)!==null){return null;}e=new bd(org,dst,J);org.mp.push(e);dst.mp.push(e);return e;};function rF(){var mc;mc=new ax();mN.push(mc);return mc;};function sF(mc){var R,e,aU;for(R=mc.mp.length-1;R>=0;R--){e=mc.mp[R];nV(e);}aU=mN.indexOf(mc);mN.splice(aU,1);};function nV(e){var aU;aU=e.org.mp.indexOf(e);e.org.mp.splice(aU,1);aU=e.dst.mp.indexOf(e);e.dst.mp.splice(aU,1);};function oB(w,x){var R,e;for(R=0;R<w.mp.length;R++){e=w.mp[R];if((e.org===w&&e.dst===x)||(e.org===x&&e.dst===w)){return e;}}return null;};function uN(){var nM,md,i,mc,R,e,aM,pt,be;nM=0;md=0;for(i=0;i<mq.length;i++){mc=mq[i];if(mc.y+mc.rows-1>md){md=mc.y+mc.rows-1;}if(mc.x+mc.cols-1>nM){nM=mc.x+mc.cols-1;}for(R=0;R<mc.lF.length;R++){e=mc.lF[R];for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];if(pt.y>md){md=Math.floor(pt.y);}if(pt.x>nM){nM=Math.floor(pt.x);}}}}for(i=0;i<mq.length;i++){mc=mq[i];switch(orientation){case 'north':break;case 'west':be=mc.x;mc.x=mc.y;mc.y=nM-be;be=mc.cols;mc.cols=mc.rows;mc.rows=be;break;case 'south':mc.x=nM-mc.x;mc.y=md-mc.y-mc.rows+1;break;case 'east':be=mc.x;mc.x=md-mc.y-mc.rows+1;mc.y=be;be=mc.cols;mc.cols=mc.rows;mc.rows=be;break;}for(R=0;R<mc.lF.length;R++){e=mc.lF[R];for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];switch(orientation){case 'north':break;case 'west':be=Math.floor(pt.x);pt.x=pt.y;pt.y=nM-be;break;case 'south':pt.x=nM-pt.x;pt.y=md-pt.y;break;case 'east':be=Math.floor(pt.x);pt.x=md-pt.y;pt.y=be;break;}e.lU[aM]=pt;}}}};function tn(){var mv,pq,pz,qT,oe,rm,ok,i,mc,R,e,aU;if(mN.length<=1){return;}mv=mN[0];pq=mv.mp[0];sy(pq);if(ml.length<mN.length){oe=[];pz=tk();oe.push(pz!==null?pz:mv);qT=ml.length;while(qT<mN.length){w=null;for(i=0;i<mN.length;i++){mc=mN[i];if(!mc.rh){w=mc;break;}}if(w!==null){pq=null;for(R=0;R<w.mp.length;R++){e=w.mp[R];u=w.pM(e);if(!u.rh){pq=e;break;}}if(pq!==null){sy(pq);qT=tK();rm=tk();oe.push(rm!==null?rm:w);}else{w.rh=true;w.po=1;qT+=1;oe.push(w);}}}ok=rF();for(i=0;i<oe.length;i++){mc=oe[i];pg(mc,ok,null);}pq=oB(oe[0],ok);sy(pq);aU=ml.indexOf(ok);ml.splice(aU,1);sF(ok);ok=null;}for(i=0;i<ml.length;i++){mc=ml[i];for(R=0;R<mc.mp.length;R++){e=mc.mp[R];if(e.org.po>e.dst.po){e.sU(e.dst,e.org);}if(e.org===mc){mc.lF.push(e);}else{mc.lY.push(e);}}mN[i]=mc;}};function tK(){var count,mc,i;count=0;for(i=0;i<mN.length;i++){mc=mN[i];if(mc.rh){count++;}}return count;};function tk(){var mv,mc,i,u,e,R,inside;mv=null;for(i=0;i<ml.length;i++){mc=ml[i];inside=true;for(R=0;R<mc.mp.length;R++){e=mc.mp[R];u=mc.pM(e);if(u.po===0){inside=false;break;}}if(inside){mv=mc;break;}}return mv;};function ud(){var mc,i,e,R,pt,aM,op,md;op=0;for(i=0;i<mN.length;i++){mc=mN[i];mc.x-=(om-1);op=Math.max(op,mc.x);for(R=0;R<mc.lF.length;R++){e=mc.lF[R];for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];pt.x-=(om-1);e.lU[aM]=pt;op=Math.max(op,Math.floor(pt.x));}}}md=0;for(i=0;i<mN.length;i++){mc=mN[i];if(mc.y+mc.rows-1>md){md=mc.y+mc.rows-1;}for(R=0;R<mc.lF.length;R++){e=mc.lF[R];for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];if(pt.y>md){md=Math.floor(pt.y);}}}}for(i=0;i<mN.length;i++){mc=mN[i];mc.x+=lT;mc.y=md-mc.y-mc.rows+1;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];pt.x+=lT;pt.y=md-pt.y;e.lU[aM]=pt;}}}lT+=1+op;};function sP(){var col,row,i,mc,nb,ng,nD;om=0;oc=0;row=0;nb=mN[0];qg(nb,0,row);row+=nb.rows;if(mN.length<=1){return;}ng=mN[1];col=Math.max(nb.lF.length+ng.lF.length-2,1);qg(ng,col,row);row+=ng.rows;nD=oB(nb,ng);nD.og=0;nD.lU.push({x:nb.x,y:nb.y});nD.lU.push({x:nb.x,y: -1});nD.lU.push({x:ng.x,y: -1});nD.lU.push({x:ng.x,y:ng.y});rJ(nb,nD);tg(ng);for(i=2;i<mN.length;i++){mc=mN[i];qg(mc,ur(mc),row);row+=mc.rows;rQ(mc);tg(mc);}function ur(mc){var aM,rr;mc.lY.sort(function(nq,nk){var qt,qo;qt=nq.og;qo=nk.og;return(qt===qo)?0:(qt<qo? -1:1);});aM=Math.floor((mc.lY.length+1)/2);rr=mc.lY[aM-1];return rr.og;};function rQ(mc){var aM,R,e,offset;aM=Math.floor((mc.lY.length+1)/2);for(R=0;R<mc.lY.length;R++){e=mc.lY[R];offset=Math.abs(aM-1-R);if(offset===0){e.lU.push({x:mc.x,y:mc.y});}else{e.lU.push({x:e.og,y:mc.y+offset-1});e.lU.push({x:mc.x,y:mc.y+offset-1});}}};function rJ(mc,nD){var aM,R,i,offset,e;aM=Math.floor((mc.lF.length-1)/2);i=0;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(e===nD){continue;}offset=Math.abs(aM-i);if(offset===0){e.lU.push({x:mc.x,y:mc.y});oA(e,mc.x);}else{if(i<aM){oA(e,om-1);}else{oA(e,oc+1);}e.lU.push({x:mc.x,y:mc.y+mc.rows-offset});e.lU.push({x:e.og,y:mc.y+mc.rows-offset});}i++;}};function tg(mc){var aM,R,i,e,offset;aM=Math.floor(mc.lF.length/2);i=0;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];offset=Math.abs(aM-i);if(offset===0){e.lU.push({x:mc.x,y:mc.y});oA(e,mc.x);}else{if(i<aM){oA(e,om-1);}else{oA(e,oc+1);}e.lU.push({x:mc.x,y:mc.y+mc.rows-offset});e.lU.push({x:e.og,y:mc.y+mc.rows-offset});}i++;}};function oA(e,col){e.og=col;if(col<om){om=col;}if(col>oc){oc=col;}};function qg(mc,x,y){var r,count;mc.x=x;mc.y=y;r=1;count=mc.mp.length;if(count>4){r+=Math.floor((count-2)/2);}else if(count===4&&mc===mN[mN.length-1]){r+=1;}mc.rows=r;mc.cols=1;}};function sy(e){var s,be,i,mc;tO();s=e.org;be=e.dst;e.G=true;s.G=true;s.qv=be;s.ri=e;ml=[];ml.push(s);ml.push(be);oh(be);for(i=0;i<ml.length;i++){mc=ml[i];mc.po=i+1;mc.rh=true;}return ml;function oh(mc){var e,R,w,x;mc.G=true;for(R=0;R<mc.mp.length;R++){e=mc.mp[R];if(!e.G){e.G=true;w=mc.pM(e);e.sU(mc,w);mc.ri=e;mc.qv=w;if(!w.G){oh(w);}else{x=w.qv;tX(mc,w,x,e);if(ml.indexOf(x)> -1){ss(w,x);}}}}};function ss(w,x){var qh,R,e,mc,sf,u,P,index,i;qh=oB(w,x);for(R=0;R<qh.qd.length;R++){e=qh.qd[R];mc=e.org;sf=oB(mc,w);u=sh(sf);P=rw(u,w,sf);if(ml.indexOf(w)<ml.indexOf(x)){P.reverse();index=ml.indexOf(u);for(i=1;i<P.length-1;i++){ml.splice(index+i-1,0,P[i]);}P.reverse();}else{index=ml.indexOf(u);for(i=1;i<P.length-1;i++){ml.splice(index+i,0,P[i]);}}for(i=0;i<P.length-2;i++){ss(P[i],P[i+1]);}}qh.qd=[];};function tX(mc,w,x,e){var y;e.path.push(w);y=x;for(;;){e.path.push(y);if(y===mc){break;}y=y.qv;}w.ri.qd.push(e);};function sh(edge){var u,mc,i;u=null;for(i=0;i<edge.path.length;i++){mc=edge.path[i];if(ml.indexOf(mc)> -1){u=mc;}}return u;};function rw(u,w,edge){var P,i,z;P=[];for(i=edge.path.indexOf(u);i<edge.path.length;i++){z=edge.path[i];P.push(z);}P.push(w);return P;};function tO(){var mc,i,e,R;for(i=0;i<mN.length;i++){mc=mN[i];mc.G=false;mc.po=0;mc.qv=null;mc.ri=null;for(R=0;R<mc.mp.length;R++){e=mc.mp[R];e.G=false;e.qd=[];e.path=[];}}}};function nB(){var mC,nd;this.pD=function(){var mv,mc,i;mC=0;nd=0;while(mC<mq.length){mv=null;for(i=0;i<mq.length;i++){mc=mq[i];if(mc.K===0){nd++;mv=mc;break;}}if(mv!==null){lC(mv);}}nP();}();function lC(mv){var mc,i,e,R;mv.K=nd;mC++;for(R=0;R<mv.mp.length;R++){e=mv.mp[R];mc=(mv===e.org)?e.dst:e.org;if(mc.K===0){lC(mc);}}};function nP(){var i,aM,mc;mh=new Array(nd);for(aM=0;aM<nd;aM++){mh[aM]=[];}for(i=0;i<mq.length;i++){mc=mq[i];mh[mc.K-1].push(mc);}}};function ax(F){var na;this.F=F;this.mp=[];this.lY=[];this.lF=[];this.G=false;this.K=0;this.po=0;this.rh=false;this.x=0;this.y=0;this.rows=0;this.cols=0;this.qv=null;this.ri=null;na=this;this.pM=function(e){return(na===e.org)?e.dst:e.org;};};function bd(org,dst,J){var na;this.org=org;this.dst=dst;this.J=J;this.G=false;this.lU=[];this.og=0;this.path=[];this.qd=[];na=this;this.sU=function(w,x){na.org=w;na.dst=x;};}},Hierarchic:function(flow,layerDistance,vertexDistance,orientation,xmargin,ymargin,layerWidth){var nJ,pr,pj,lP,sb,bc,mq,nR,nl,oC,lX,method,S,fC,oZ,mN,mh,mi,lT,nL,oV,st,rU,sk,qH,pO,oW,pp,oK,ot,ny,pP,pb,lQ,step,qr,qO,qV,nN,shake,qX,qj,pI,pn,nQ,qD;nL='0';oV='1';st='2';nJ=50;pr=50;lP=5;pj='north';sb=0;rU=2;sk=2;qH=50;pO=3;pF=1.5;oW=0.06;pp=0.05;oK=0.4;ot=0.9;ny=1.0;pP=0.01;pb=1.0;if(flow===null||flow===undefined){return;}if(vertexDistance===undefined||vertexDistance<=0){vertexDistance=nJ;}if(layerDistance===undefined||layerDistance<=0){layerDistance=pr;}if(orientation===undefined||orientation===null){orientation=pj;}if(xmargin===undefined||xmargin<=0){xmargin=lP;}if(ymargin===undefined||ymargin<=0){ymargin=lP;}if(layerWidth===undefined||layerWidth<0){layerWidth=sb;}S=[];fC=[];mq=[];nt={x:0,y:0,w:0,h:0};layers=[];method="m0ub2db2ua1da0u";nG();oS();oZ=new nB(mq);nl=vertexDistance/2;lT=0;for(mi=0;mi<mh.length;mi++){mN=mh[mi];so();}oa();function nG(){var i,F,items;items=flow.getItems();bc=[];for(i in items){if(flow.isNode(items[i])){F=items[i];if(!F.isExcludedFromLayout){bc.push(items[i]);}}}};function oS(){var i,R,mc,u,J,bA,lZ;for(i=0;i<bc.length;i++){os(bc[i]);}for(i=0;i<mq.length;i++){mc=mq[i];bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.org===mc.F){lZ=J.dst;if(!J.isExcludedFromLayout&&J.org!==J.dst&& !lZ.isExcludedFromLayout){u=lZ.nC;pg(mc,u,J);}}}}};function oa(){var nt,be,pt,O,i,R,aM,mc,bA,J,x,y,mW,mT;flow.beginUpdate();nt=mG();for(i=0;i<mq.length;i++){mc=mq[i];x=mc.x;y=mc.y;mc.F.nh={x:mc.F.getLeft(),y:mc.F.getTop()};x-=nt.x;y-=nt.y;switch(orientation){case 'north':break;case 'west':be=x;x=y;y=nt.w-be;be=mc.w;mc.w=mc.h;mc.h=be;break;case 'south':x=nt.w-x;y=nt.h-y;break;case 'east':be=x;x=nt.h-y;y=be;be=mc.w;mc.w=mc.h;mc.h=be;break;}x-=mc.w/2;y-=mc.h/2;x+=xmargin;y+=ymargin;mc.F.setLeft(x);mc.F.setTop(y);bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}J.aP=true;J.setIsOrgPointAdjustable(false);J.setIsDstPointAdjustable(false);}}for(i=0;i<mq.length;i++){mc=mq[i];bA=mc.F.getLinks();for(R=0;R<bA.length;R++){J=bA[R];if(J.isExcludedFromLayout){continue;}if(J.aP){J.aP=false;}else{continue;}if(J.org!==J.dst){J.setLineStyle('polyline');if(J.points.length>2){J.clearPoints();}if(J.pinOrg!==undefined&&J.pinOrg!==null){mW=J.org.getLeft()-J.org.nh.x;mT=J.org.getTop()-J.org.nh.y;pt=J.points[0];J.setPoint(pt.x+mW,pt.y+mT,0);}if(J.pinDst!==undefined&&J.pinDst!==null){mW=J.dst.getLeft()-J.dst.nh.x;mT=J.dst.getTop()-J.dst.nh.y;pt=J.points[1];J.setPoint(pt.x+mW,pt.y+mT,1);}}else{mW=mc.F.getLeft()-mc.F.nh.x;mT=mc.F.getTop()-mc.F.nh.y;if(J.pinOrg!==undefined&&J.pinOrg!==null){aM=0;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}for(aM=1;aM<J.points.length-1;aM++){pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}if(J.pinDst!==undefined&&J.pinDst!==null){aM=J.points.length-1;pt=J.points[aM];J.setPoint(pt.x+mW,pt.y+mT,aM);}}}}for(i=0;i<mq.length;i++){mc=mq[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(e.lU.length>0){for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];O=pt;O.x-=nt.x;O.y-=nt.y;switch(orientation){case 'north':break;case 'west':be=O.x;O.x=O.y;O.y=nt.w-be;break;case 'south':O.x=nt.w-O.x;O.y=nt.h-O.y;break;case 'east':be=O.x;O.x=nt.h-O.y;O.y=be;break;}O.x+=xmargin;O.y+=ymargin;e.J.addPoint(O.x,O.y);}}}}flow.endUpdate();};function os(F){var mc;mc=new ax(F);F.nC=mc;mc.V={x:F.x,y:F.y};mA={x:F.getLeft()-F.getWidth()/2,y:F.getTop()-F.getHeight()/2,w:F.getWidth(),h:F.getHeight()};mc.x=mA.x+mA.w/2;mc.y=mA.y+mA.h/2;if(orientation==='north'||orientation==='south'){mc.w=mA.w;mc.h=mA.h;}else{mc.w=mA.h;mc.h=mA.w;}mq.push(mc);};function rF(){var mc;mc=new ax();mN.push(mc);return mc;};function sF(mc){var R,e,aU;for(R=mc.lF.length-1;R>=0;R--){e=mc.lF[R];nV(e);}for(R=mc.lY.length-1;R>=0;R--){e=mc.lY[R];nV(e);}aU=mN.indexOf(mc);mN.splice(aU,1);};function pg(org,dst,J){var e;if(org===null||dst===null||org===dst){return null;}e=new bd(org,dst,J);org.lF.push(e);dst.lY.push(e);return e;};function nV(e){var aU;aU=e.org.lF.indexOf(e);e.org.lF.splice(aU,1);aU=e.dst.lY.indexOf(e);e.dst.lY.splice(aU,1);};function mG(){var i,R,aM,mc,e,pt,mA,nt;for(i=0;i<mq.length;i++){mc=mq[i];mA={x:mc.x-mc.w/2,y:mc.y-mc.h/2,w:mc.w,h:mc.h};if(i===0){nt=mA;}else{nt=jJ(nt,mA);}}for(i=0;i<mq.length;i++){mc=mq[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];for(aM=0;aM<e.lU.length;aM++){pt=e.lU[aM];if(pt.x<nt.x){nt.w+=nt.x-pt.x;nt.x=pt.x;}else if(pt.x>nt.x+nt.w){nt.w+=pt.x-(nt.x+nt.w);}if(pt.y<nt.y){nt.h+=nt.y-pt.y;nt.y=pt.y;}else if(pt.y>nt.y+nt.h){nt.h+=pt.y-(nt.y+nt.h);}}}}return nt;};function jJ(mF,mo){var left,top,right,bottom;right=Math.max(mF.x+mF.w,mo.x+mo.w);bottom=Math.max(mF.y+mF.h,mo.y+mo.h);left=Math.min(mF.x,mo.x);top=Math.min(mF.y,mo.y);return{x:left,y:top,w:right-left,h:bottom-top};};function so(){var i,mc,mA;sQ();uc();sp();rS();nt={x:0,y:0,w:0,h:0};for(i=0;i<mN.length;i++){mc=mN[i];mA={x:mc.x-mc.w/2,y:mc.y-mc.h/2,w:mc.w,h:mc.h};if(i===0){nt=mA;}else{nt=jJ(nt,mA);}}for(i=0;i<mN.length;i++){mc=mN[i];mc.x+=lT-nt.x;mc.y+= -nt.y;}lT+=nl+nt.w;uS();sn();};function sQ(){var i,mc,R,e,u,ow,nK,od,qw,pG,nT,qK,lF;pG=0;nT=0;qK=mN.length;nR=new Array(qK);do{do{ow=false;for(i=0;i<mN.length;i++){mc=mN[i];od=0;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(!e.dst.oD){od++;}}if(od===0&& !mc.oD){mc.oD=true;qK--;ow=true;nR[mN.length-pG-1]=mc;pG++;break;}}if(!ow){break;}}while(true);do{ow=false;for(i=0;i<mN.length;i++){mc=mN[i];nK=0;for(R=0;R<mc.lY.length;R++){e=mc.lY[R];if(!e.org.oD){nK++;}}if(nK===0&& !mc.oD){mc.oD=true;qK--;ow=true;nR[nT]=mc;nT++;break;}}if(!ow){break;}}while(true);qw=0;ow=false;u=null;for(i=0;i<mN.length;i++){mc=mN[i];nK=0;od=0;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(!e.dst.oD){od++;}}for(R=0;R<mc.lY.length;R++){e=mc.lY[R];if(!e.org.oD){nK++;}}if(od-nK>=qw&& !mc.oD){mc.oD=true;qK--;ow=true;u=mc;qw=od-nK;break;}}if(ow){nR[nT]=u;nT++;}}while(qK>0);for(i=0;i<nR.length;i++){mc=nR[i];mc.pv=i;}lF=[];for(i=0;i<mN.length;i++){mc=mN[i];lF=mc.lF.slice();for(R=0;R<lF.length;R++){e=lF[R];if(e.dst.pv<e.org.pv){e.aA=true;e.bb();}}}};function sn(){var mc,i,e,R,lF;lF=[];for(i=0;i<mN.length;i++){mc=mN[i];lF=mc.lF.slice();for(R=0;R<lF.length;R++){e=lF[R];if(e.aA){e.aA=false;e.bb();}}}};function uc(){oC=0;if(layerWidth>0){tp(layerWidth);}else{tJ();}ta();tj();};function tp(width){var pR,aM,qR,S,fC,qB,i,mc;qR=[];S=[];fC=[];qB=0;for(i=0;i<mq.length;i++){mc=mq[i];if(mc.lY.length>qB){qB=mc.lY.length;}}for(aM=0;aM<mN.length;aM++){mc=sx();if(mc!==null){mc.label=aM+1;}}pR=0;aM=0;qR.push(0);do{mc=tS(aM+1);if(mc===null||qR[aM]===width){aM++;qR.push(0);}if(mc!==null){qR[aM]++;mc.mw=aM+1;pR++;}}while(pR<mN.length);oC=aM+1;};function tS(mw){var bC,qJ,mc,i,e,R,label,qU;bC=null;label=0;for(i=0;i<mN.length;i++){mc=mN[i];if(mc.mw===0){qJ=true;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];qU=e.dst.mw;if(qU===0||qU===mw){qJ=false;break;}}if(qJ){if(mc.label>label){label=mc.label;bC=mc;}}}}return bC;};function sx(){var bC,sizeS,lM,mc,i,e,R,aM,qe;bC=null;sizeS=0;for(i=0;i<mN.length;i++){mc=mN[i];if(mc.label===0){lM=mc.lY.length;if(lM===0){bC=mc;sizeS=lM;}else{aM=0;qe=true;for(R=0;R<mc.lY.length;R++){e=mc.lY[R];if(e.org.label===0){qe=false;break;}else{fC[aM]=e.org.label;aM++;}}if(qe){if(bC===null||sG(S,fC,sizeS,lM)>0){bC=mc;sizeS=lM;if(sizeS>0){for(aM=0;aM<sizeS;aM++){S[aM]=fC[aM];}}}}}}}return bC;};function sG(S,fC,sizeS,lM){var qS,pL,aM;if(sizeS===0&&lM===0){return 0;}else if(sizeS===0&&lM!==0){return-1;}else if(sizeS!==0&&lM===0){return 1;}else{qS=rY(S,sizeS);pL=rY(fC,lM);if(S[qS]<fC[pL]){return-1;}else if(S[qS]>fC[pL]){return 1;}else{for(aM=qS;aM<sizeS-1;aM++){S[aM]=S[aM+1];}for(aM=pL;aM<lM-1;aM++){fC[aM]=fC[aM+1];}return sG(S,fC,sizeS-1,lM-1);}}};function rY(S,sizeS){var max,aM,pS;max=0;pS=0;for(aM=0;aM<sizeS;aM++){if(S[aM]>max){max=S[aM];pS=aM;}}return pS;};function tJ(){var i,mc,e,R,qZ,rk,mw;for(i=0;i<mN.length;i++){mc=mN[i];if(mc.lF.length===0){mc.mw=1;}}oC=1;qZ=1;for(;;){rk=false;for(i=0;i<mN.length;i++){mc=mN[i];if(mc.mw===qZ){rk=true;mw=mc.mw+1;for(R=0;R<mc.lY.length;R++){e=mc.lY[R];if(mw>e.org.mw){e.org.mw=mw;}if(mw>oC){oC=mw;}}}}if(!rk){break;}qZ++;}};function tj(){var i,da,qu,oP,lX,R;layers=[];for(i=0;i<oC;i++){layers[i]=new uV();}for(i=0;i<mN.length;i++){mc=mN[i];da=layers[mc.mw-1];if(da.cy<mc.h){da.cy=mc.h;}}lX=layers[oC-1];lX.y=lX.cy/2;for(R=oC-2;R>=0;R--){qu=layers[R];oP=layers[R+1];qu.y=oP.y+oP.cy/2+qu.cy/2+layerDistance;}vc();};function vc(){var i,mc;for(i=0;i<mN.length;i++){mc=mN[i];if(mc.lY.length===0&& !mc.aX){sd(mc);}}};function sd(mv){var lX,e,R;mv.aX=true;lX=layers[mv.mw-1];mv.x=lX.x+lX.mq.length*nl;mv.y=lX.y;if(mv.mw===1){lX.x+=vertexDistance+mv.w;}lX.mq.push(mv);for(R=0;R<mv.lF.length;R++){e=mv.lF[R];if(!e.dst.aX){sd(e.dst);}}};function sp(){var oQ,pN,rD,R;for(oQ=0;oQ<method.length;oQ+=3){pN=method[oQ];oU=method[oQ+1];rD=method[oQ+2];switch(rD){case 'u':for(R=1;R<oC;R++){switch(pN){case 'b':rV(R,oU);break;case 'm':sH(R,oU);break;case 'a':rR(R,oU);break;}}break;case 'd':for(R=oC-2;R>=0;R--){switch(pN){case 'b':rV(R,oU);break;case 'm':sH(R,oU);break;case 'a':rR(R,oU);break;}}break;default:break;}}};function rV(mw,nj){var lX,i,mc,u,nu,ou;lX=layers[mw];for(i=0;i<lX.mq.length;i++){mc=lX.mq[i];mc.x=ag(mc,nj);}lX.mq.sort(function(nb,ng){return(nb.x===ng.x)?0:(nb.x<ng.x? -1:1);});for(i=1;i<lX.mq.length;i++){mc=lX.mq[i];u=lX.mq[i-1];nu=(mc.w+u.w)/2+nl;ou=mc.x-u.x;if(ou<nu){mc.x=u.x+nu;}}};function ag(mc,nj){var bar,e,R;bar=0;switch(nj){case nL:if(mc.lF.length>0){bar=0;for(R=0;R<mc.lF.length;R++){e=mc.lF[R];bar+=e.dst.x;}bar=bar/mc.lF.length;}else{bar=mc.x;}break;case oV:if(mc.lY.length>0){bar=0;for(R=0;R<mc.lY.length;R++){e=mc.lY[R];bar+=e.org.x;}bar=bar/mc.lY.length;}else{bar=mc.x;}break;case st:bar=0;for(R=0;R<mc.lY.length;R++){e=mc.lY[R];bar+=e.org.x;}for(R=0;R<mc.lF.length;R++){e=mc.lF[R];bar+=e.dst.x;}bar=bar/(mc.lY.length+mc.lF.length);break;}return bar;};function sH(mw,nj){var lX,mV,i,mc,u,be,nu,ou;lX=layers[mw];for(i=0;i<lX.mq.length;i++){mc=lX.mq[i];mV=bw(mc,nj);if(mV>0){mc.x=mV;}}lX.mq.sort(function(nb,ng){return(nb.x===ng.x)?0:(nb.x<ng.x? -1:1);});for(i=1;i<lX.mq.length;i++){mc=lX.mq[i];u=lX.mq[i-1];nu=(mc.w+u.w)/2+nl;if((nj===nL&&mc.lF.length===0)||(nj===oV&&mc.lY.length===0)){mc.x=u.x+nu;}else{ou=mc.x-u.x;if(ou<nu){if((mc.lF.length%2)!==0&&(u.lF.length%2)===0){mc.x=u.x;u.x+=nu;be=lX.mq[i];lX.mq[i]=lX.mq[i-1];lX.mq[i-1]=be;}else{mc.x=u.x+nu;}}}}};function bw(mc,nj){var nq,nk,qq,x1,x2,oX,mV,mR,R,e;mV=0;mR=[];switch(nj){case nL:for(R=0;R<mc.lF.length;R++){e=mc.lF[R];mR.push(e);}switch(mc.lF.length){case 0:mV=0;break;case 1:nq=mR[0];mV=nq.dst.x;break;case 2:nq=mR[0];nk=mR[1];mV=(nq.dst.x+nk.dst.x)/2;break;case 3:case 4:nq=mR[mc.lF.length===3?0:3];nk=mR[1];qq=mR[2];x1=nq.dst.x;x2=nk.dst.x;oX=qq.dst.x;if(Math.min(x1,oX)<=x2&&x2<=Math.max(x1,oX)){mV=x2;}else if(Math.min(x1,x2)<=oX&&oX<=Math.max(x1,x2)){mV=oX;}else{mV=x1;}break;default:mR.sort(function(nq,nk){return(nq.dst.x===nk.dst.x)?0:(nq.dst.x<nk.dst.x? -1:1);});nq=mR[Math.floor(mR.length/2)];mV=nq.dst.x;break;}break;case oV:for(R=0;R<mc.lY.length;R++){e=mc.lY[R];mR.push(e);}switch(mc.lY.length){case 0:mV=0;break;case 1:nq=mR[0];mV=nq.org.x;break;case 2:nq=mR[0];nk=mR[1];mV=(nq.org.x+nk.org.x)/2;break;case 3:case 4:nq=mR[mc.lY.length===3?0:3];nk=mR[1];qq=mR[2];x1=nq.org.x;x2=nk.org.x;oX=qq.org.x;if(Math.min(x1,oX)<=x2&&x2<=Math.max(x1,oX)){mV=x2;}else if(Math.min(x1,x2)<=oX&&oX<=Math.max(x1,x2)){mV=oX;}else{mV=x1;}break;default:mR.sort(function(nq,nk){return(nq.org.x===nk.org.x)?0:(nq.org.x<nk.org.x? -1:1);});nq=mR[Math.floor(mR.length/2)];mV=nq.org.x;break;}break;}return mV;};function rR(mw,nj){var lX,rd,aM,u,mc,be,oT,pf;lX=layers[mw];rd=true;do{rd=false;for(aM=0;aM<lX.mq.length-1;aM++){u=lX.mq[aM];mc=lX.mq[aM+1];oT=0;pf=0;sZ(u,mc,oT,pf,nj);if(oT>pf){lX.mq[aM]=mc;lX.mq[aM+1]=u;be=u.x;u.x=mc.x;mc.x=be;rd=true;}}}while(rd);lX.mq.sort(function(nb,ng){return(nb.x===ng.x)?0:(nb.x<ng.x? -1:1);});};function sZ(u,mc,ts,tM,nj){var oT,pf,R,aM,nq,nk,oO,nI;oT=0;pf=0;switch(nj){case nL:for(R=0;R<u.lF.length;R++){nq=u.lF[R];oO=nq.dst.x;for(aM=0;aM<mc.lF.length;aM++){nk=mc.lF[aM];nI=nk.dst.x;if(nI<oO){oT++;}if(nI>oO){pf++;}}}break;case oV:for(R=0;R<u.lY.length;R++){nq=u.lY[R];oO=nq.org.x;for(aM=0;aM<mc.lY.length;aM++){nk=mc.lY[aM];nI=nk.org.x;if(nI<oO){oT++;}if(nI>oO){pf++;}}}break;}ts=oT;tM=pf;};function uk(){var dX,mw;dX=0;for(mw=1;mw<oC;mw++){dX+=uZ(mw);}return dX;};function uZ(mw){var lX,qp,nb,ng,i,aM;lX=layers[mw];qp=0;for(i=0;i<lX.mq.length;i++){nb=lX.mq[i];for(aM=0;aM<lX.mq.length;aM++){ng=lX.mq[aM];if(ng!==nb){if(nb.pt.x<ng.pt.x){qp+=rO(nb,ng);}}}}return qp;};function rO(nb,ng){var oT,R,nb,oO,nI;oT=0;for(R=0;R<nb.lF.length;R++){nq=nb.lF[R];oO=nq.dst.x;for(aM=0;aM<ng.lF.length;aM++){nk=ng.lF[aM];nI=nk.dst.x;if(nI<oO){oT++;}}}return oT;};function tY(){var mc,ng,i,e,R,aM,span,qb,pE;for(i=0;i<nR.length;i++){mc=nR[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];span=e.org.mw-e.dst.mw;if(span>1){pE=span;ng=e.dst;for(aM=0;aM<ng.lY.length;aM++){nk=ng.lY[aM];qb=nk.org.mw-nk.dst.mw;if(qb<pE){pE=qb;}}if(pE>1){e.dst.mw+=pE-1;}}}}};function ta(){var sl,i,R,aM,org,dst,span,e,nb,ng;if(layerWidth===0){tY();}sl=mN.length;for(i=0;i<sl;i++){org=mN[i];for(R=0;R<org.lF.length;R++){e=org.lF[R];dst=e.dst;span=org.mw-dst.mw;if(span>1){e.aj=true;e.sq=dst;nb=org;for(aM=1;aM<span;aM++){ng=rF();if(ng!==null){ng.w=rU;ng.h=sk;ng.mw=org.mw-aM;ng.ok=true;if(aM===1){e.H(ng);}else{pg(nb,ng,null);}nb=ng;}}pg(nb,dst,null);}}}};function uS(){var mc,e,i,R,lL,qE,pt,ad,O,qW;for(i=0;i<mN.length;i++){mc=mN[i];for(R=0;R<mc.lF.length;R++){e=mc.lF[R];if(e.aj){lL=e.dst;pt={x:lL.x,y:lL.y};e.H(e.sq);e.lU.push(pt);qE=lL.lF[0];lL=qE.dst;if(lL.ok){do{ad=pt;pt={x:lL.x,y:lL.y};qE=lL.lF[0];lL=qE.dst;O={x:lL.x,y:lL.y};if(Math.abs(pt.x-ad.x)>nl||Math.abs(pt.x-O.x)>nl){e.lU.push(pt);}}while(lL.ok);}e.aj=false;}}}qW=[];for(i=0;i<mN.length;i++){mc=mN[i];if(mc.ok){qW.push(mc);}}for(i=0;i<qW.length;i++){mc=qW[i];sF(mc);}};function rS(){if(mN.length<=1){return;}tF();tx();vd();};function tF(){var mw,lX,i,R,mc,e,oM;distance=vertexDistance;lQ=distance*distance;nf={x:0,y:0};nQ=0;step=pb;qO=ot;qr=oK;qV=ny;nN=pP;qX=pF*distance;qj=oW*distance;pn=pp;size=mN.length;pI=pn*pn*lQ*size;qD=Math.min(pO*size*size,qH);for(mw=0;mw<oC;mw++){lX=layers[mw];for(i=0;i<lX.mq.length;i++){mc=lX.mq[i];mc.y2=mc.y;oM=mc.lY.length+mc.lF.length;mc.pa=1.0+oM/3.0;mc.nH=qj;nQ+=mc.nH*mc.nH;nf.x+=mc.x;nf.y+=mc.y;mc.mx=[];for(R=0;R<mc.lY.length;R++){e=mc.lY[R];mc.mx.push(e.org);}for(R=0;R<mc.lF.length;R++){e=mc.lF[R];mc.mx.push(e.dst);}mc.nF=i>0?lX.mq[i-1]:null;mc.next=i<lX.mq.length-1?lX.mq[i+1]:null;}}};function tx(){var oI;for(oI=0;oI<qD;oI++){if(nQ<pI){break;}round();}};function vd(){var mc,i;for(i=0;i<mN.length;i++){mc=mN[i];mc.y=mc.y2;}};function round(){var i,mc,mO;for(i=0;i<mN.length;i++){mc=mN[i];mO=qn(mc);qF(mc,mO);}};function qF(mv,mO){var be,qy,nU,d,bL,nu;be=mv.nH;if(be!==0.0){nQ-=be*be;nU=mO.x*mv.mO.x+mO.y*mv.mO.y;qy=mO.x*mv.mO.y-mO.y*mv.mO.x;if(Math.abs(nU)>0.5){be+=qr*nU;be=Math.min(be,qX);}else{mv.dir+=qO*qy/be;be-=be*qV*Math.abs(mv.dir)/size;be=Math.max(be,2);}mv.nH=be;nQ+=be*be;}d={x:mO.x*step*be,y:mO.y*step*be};bL=true;if(mv.next!==null){nu=(mv.w+mv.next.w)/2+nl;if(mv.next.x-(mv.x+d.x)<nu){bL=false;}}if(mv.nF!==null){nu=(mv.w+mv.nF.w)/2+nl;if(mv.x+d.x-mv.nF.x<nu){bL=false;}}if(bL){mv.x+=d.x;mv.y+=d.y;mv.mO=mO;nf.x+=d.x;nf.y+=d.y;}};function qn(mv){var mO,d,e,i,mc,pi;mO={x:0,y:0};d={x:0,y:0};mO.x+=(nf.x/size-mv.x)*mv.pa*nN;mO.y+=(nf.y/size-mv.y)*mv.pa*nN;for(i=0;i<mN.length;i++){mc=mN[i];if(mv!==mc&&mc.mw===mv.mw){d.x=mv.x-mc.x;d.y=mv.y-mc.y;e=d.x*d.x+d.y*d.y;if(e!==0.0){mO.x+=d.x*lQ/e;mO.y+=d.y*lQ/e;}}}for(i=0;i<mv.mx.length;i++){mc=mv.mx[i];d.x=mv.x-mc.x;d.y=mv.y-mc.y;e=(d.x*d.x+d.y*d.y)/mv.pa;mO.x-=d.x*e/lQ;mO.y-=d.y*e/lQ;}pi=Math.sqrt(mO.x*mO.x+mO.y*mO.y);if(pi!==0.0){mO.x/=pi;mO.y/=pi;}return mO;};function nB(){var mC,nd;this.pD=function(){var mv,mc,i;mC=0;nd=0;while(mC<mq.length){mv=null;for(i=0;i<mq.length;i++){mc=mq[i];if(mc.K===0){nd++;mv=mc;break;}}if(mv!==null){lC(mv);}}nP();}();function lC(mv){var mc,e,R;mv.K=nd;mC++;for(R=0;R<mv.lF.length;R++){e=mv.lF[R];mc=e.dst;if(mc.K===0){lC(mc);}}for(R=0;R<mv.lY.length;R++){e=mv.lY[R];mc=e.org;if(mc.K===0){lC(mc);}}};function nP(){var i,aM,mc;mh=new Array(nd);for(aM=0;aM<nd;aM++){mh[aM]=[];}for(i=0;i<mq.length;i++){mc=mq[i];mh[mc.K-1].push(mc);}}};function uV(){this.x=0;this.y=0;this.cy=0;this.mq=[];};function ax(F){var na;this.F=F;this.lY=[];this.lF=[];this.x=0;this.y=0;this.w=0;this.h=0;this.K=0;this.mw=0;this.pv=0;this.label=0;this.G=false;this.ok=false;this.oD=false;this.aX=false;this.next=null;this.nF=null;this.mO={x:0,y:0};this.nH=0;this.dir=0;this.pa=0;this.mx=[];this.y2=0;};function bd(org,dst,J){var na;this.org=org;this.dst=dst;this.J=J;this.sq=null;this.lU=[];this.G=false;this.aA=false;this.aj=false;na=this;this.bb=function(){var be,aU;aU=na.org.lF.indexOf(na);na.org.lF.splice(aU,1);aU=na.dst.lY.indexOf(na);na.dst.lY.splice(aU,1);be=na.org;na.org=na.dst;na.dst=be;na.org.lF.push(na);na.dst.lY.push(na);na.lU.reverse();};this.H=function(gO){var aU;aU=na.dst.lY.indexOf(na);na.dst.lY.splice(aU,1);na.dst=gO;na.dst.lY.push(na);};}}};